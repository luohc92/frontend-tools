var re=Object.defineProperty;var ce=(t,n,e)=>n in t?re(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var y=(t,n,e)=>(ce(t,typeof n!="symbol"?n+"":n,e),e);import{d as fe,r as T,a as pe,E as me,c as ye,b as V,e as a,w as c,o as he,t as de,f as w,n as ge}from"./index.43e46641.js";import{c as _e,E as ve,a as Ee,b as Ce,d as Te,e as Ae,f as be,g as Oe,h as Ve,_ as M,i as N}from"./mirrorEditor.vue_vue_type_style_index_0_lang.1bb6ad86.js";const Ne="Root",B="string",L="number",Y="null",x="boolean",P="undefined",D="Object",q="Array",U="Comment",je="root",A="$ARRAY_ITEM$",K="$LAST_COMMENT$",Se="$NEXT_COMMENT$",R="array should be closed",$e="comment is illegal",we="value is illegal";function E(t){const{offset:n,column:e,line:s}=t;return{offset:n,column:e,line:s}}function G(t,n,e){return e=e||E(t),{start:n,end:e,source:t.originalSource.slice(n.offset,e.offset)}}function ke(t,n){return{options:n,column:1,line:1,offset:0,originalSource:t,source:t}}function Me(t){return{key:je,type:Ne,value:t}}function z(t){return!t.source}function Re(t,n,e=n.length){let s=0,i=-1;for(let l=0;l<e;l++)n.charCodeAt(l)===10&&(s++,i=l);t.offset+=e,t.line+=s,t.column=i===-1?t.column+e:e-i}function r(t,n){const e=t.source;Re(t,e,n),t.source=e.slice(n)}function h(t){const n=/^[\t\r\n\f ]+/.exec(t.source);n&&n[0]&&r(t,n[0].length)}function J(t,n){h(t);const e=E(t);let s=n||Fe(t);const{value:i,type:l}=Pe(t),u=G(t,e);return h(t),t.source[0]===","&&(r(t,1),h(t)),{key:s,value:i,type:l,loc:u}}function W(t){const n=[];for(;!z(t);){h(t);const e=t.source;if(e[0]==="{")r(t,1);else{if(e[0]==="}")return r(t,1),h(t),n;if(e[0]==="/")if(e[1]==="/"){const s=n[n.length-1];let i=-1;s&&(i=s.loc.end.line),n.push(X(t,i)),h(t)}else throw new Error($e);else n.push(J(t))}}return n}function Fe(t){const n=t.source[0];let e=[];return n==='"'?e=/^"(.[^"]*)/i.exec(t.source):n==="'"?e=/^'(.[^']*)/i.exec(t.source):(e=/(.[^:]*)/i.exec(t.source),e[1]=e[1].trim()),r(t,e[0].length+1),h(t),t.source[0]===":"&&(r(t,1),h(t)),e[1]}function Ie(t){const n=/^([0-9]*)/i.exec(t.source);return r(t,n[0].length),n[1]}function Be(t){const n=/^["|']([^"|']*)/i.exec(t.source);return r(t,n[0].length+1),n[1]}function Le(t){return r(t,4),"null"}function Ye(t){const n=/^(true|false)/i.exec(t.source);return r(t,n[0].length),n[1]}function xe(t){return r(t,9),"undefined"}function Pe(t){let n=null,e=null,s=t.source[0];if(/^[0-9]/.test(s))n=Ie(t),e=L;else if(s==='"'||s==="'")n=Be(t),e=B;else if(s==="[")r(t,1),n=De(t),e=q;else if(s==="{")n=W(t),e=D;else if(t.source.indexOf("null")===0)n=Le(t),e=Y;else if(t.source.indexOf("true")===0||t.source.indexOf("false")===0)n=Ye(t),e=x;else if(t.source.indexOf("undefined")===0)n=xe(t),e=P;else throw new Error(we);return{value:n,type:e}}function De(t){const n=[];let e=E(t).line;for(h(t);!z(t);){const s=t.source[0];if(s==="]")return r(t,1),n;if(s==="}"||s===":")throw new Error(R);if(t.source.indexOf("//")===0){const i=X(t,e);n.push(i),h(t)}else{const i=J(t,A);e=i.loc.end.line,n.push(i)}}throw new Error(R)}function X(t,n){const e=E(t).line,s=n===e?K:Se,i=/^\/\/\s*(.[^\t\n\r\f]*)/i.exec(t.source),l=E(t),u=i[1];return r(t,i[0].length),{key:s,value:u,type:U,loc:G(t,l)}}function qe(t,n){const e=ke(t,n);return Me(W(e))}function H(t){return Object.prototype.toString.call(t)}function j(t){return typeof t=="object"&&H(t).slice(8,-1)==="Array"}function S(t){return typeof t=="object"&&H(t).slice(8,-1)==="Object"}function Ue(t){return t.replace(/( |^)[a-z]/g,n=>n.toUpperCase())}function Ke(t){let n=Object.keys(t).sort(),e="{";for(let s of n)e+=`${s}:${t[s]},`;return e=e.replace(/,$/,""),e+="}",e}function Ge(t,n=""){const e=[],s={};let i=0;const l=[],u={};for(let p=0;p<t.length;p++){const _=t[p];S(_)?(i++,Object.keys(_).forEach(g=>{u[g]=_[g],s[`${n}>${g}`]?s[`${n}>${g}`]+=1:s[`${n}>${g}`]=1})):l.push(_)}return Object.keys(s).forEach(p=>{s[p]<i&&e.push(p)}),Object.keys(u).length&&l.push(u),{optionalKeys:e,newTypes:l}}function ze(t,n,e=""){const s=e+">"+n;for(const i of t)if(s===i)return!0;return!1}let o=Q();function Q(){return{comments:{},i:0,lastI:null,lastNode:null,nextComment:[]}}function v(t,n,e){t.i=o.i,t.key===A?(o.nextComment=[],e.parseArray&&(n.typeValue=n.typeValue||[],n.typeValue.push(t.type))):(n.typeValue=n.typeValue||{},n.typeValue[t.key]=t.type,$(t))}function $(t){if(o.lastNode=t,o.nextComment.length){const n=o.comments,e=t.key+o.i;n[e]=n[e]||[],n[e]=n[e].concat(o.nextComment),o.nextComment=[]}}function F(t){o.nextComment.length&&(t.nextComment=o.nextComment,o.nextComment=[])}function I(t){if(t.nextComment){const n=o.comments,e=t.key+t.i;n[e]=n[e]||[],n[e]=n[e].concat(t.nextComment),o.nextComment=[]}}function Z(t,n,e){t.forEach(s=>{let i=e[s.type];i&&i.entry&&i.entry(s,n),j(s.value)&&Z(s.value,s,e),i&&i.exit&&i.exit(s,n)})}function Je(t,n){let e=n.Root;return e&&e.entry&&e.entry(t,null),Z(t.value,t,n),e&&e.exit&&e.exit(t,null),t}function We(t,n){return Je(t,{[B]:{entry(e,s){v(e,s,n)}},[L]:{entry(e,s){v(e,s,n)}},[D]:{entry(e,s){e.key===A?(o.nextComment=[],n.parseArray&&(s.typeValue=s.typeValue||[],e.typeValue={},s.typeValue.push(e.typeValue),e.i=o.i,o.i++)):(s.typeValue=s.typeValue||{},s.typeValue[e.key]=e.typeValue={},n.comment==="inline"?F(e):n.comment==="block"&&$(e),e.i=o.i,o.i++)},exit(e){n.comment==="inline"&&(e.i=o.i,I(e)),o.lastNode=e}},[q]:{entry(e,s){e.key===A?(o.nextComment=[],n.parseArray&&(s.typeValue=s.typeValue||[],e.typeValue=[],s.typeValue.push(e.typeValue))):(s.typeValue=s.typeValue||{},s.typeValue[e.key]=e.typeValue=[],n.comment==="inline"?F(e):n.comment==="block"&&$(e)),e.i=o.i},exit(e){n.comment==="inline"&&(e.i=o.i,I(e)),o.lastNode=e}},[Y]:{entry(e,s){v(e,s,n)}},[x]:{entry(e,s){v(e,s,n)}},[P]:{entry(e,s){v(e,s,n)}},[U]:{entry(e){if(e.key===K){const s=o.lastNode.key+o.lastNode.i;o.comments[s]=o.comments[s]||[],o.comments[s].push(e.value)}else o.nextComment.push(e.value)}}}),t.comments=o.comments,o=Q(),t}class Xe{constructor(n,e){y(this,"ast");y(this,"options");y(this,"vars");y(this,"i");y(this,"j");y(this,"level");y(this,"prefix");y(this,"suffix");y(this,"objValueMap");this.ast=n,this.options=e,this.prefix=e.typePrefix||"",this.suffix=e.typeSuffix||"",this.vars="",this.i=0,this.j=-1,this.level=1,this.objValueMap=new Map}beginGen(){const n=this.genName("Result"),e=this.ast.typeValue,s=this.gen(e),i=this.options.genType==="interface";return`${this.vars}${this.options.genType} ${n}${i?"":" ="} ${s}${this.options.semicolon?";":""}
`}gen(n,e=[]){let s=`{
`;for(const i in n){const l=n[i];this.options.comment==="block"&&(s+=this.genBlockComment(i)),s+=this.genKey(i,ze(e,i)),S(l)?s+=this.genObjcet(i,l):j(l)?s+=this.options.parseArray?this.genArray(i,l):"Array<any>":s+=l,this.options.semicolon&&(s+=";"),this.options.comment==="inline"&&(s+=this.genInlineComment(i)),s+=`
`}return this.options.splitType||(s+=this.genFormatChat(this.level-1)),s+="}",s}genName(n){return this.j++,`${this.prefix}${Ue(n)}${this.suffix}`}genKey(n,e=!1){return`${this.genFormatChat(this.level)}${n}${this.options.required&&!e?": ":"?: "}`}genFormatChat(n){const e=this.options.indent||2;return this.options.splitType?" ".repeat(e):" ".repeat(n*e)}genInlineComment(n){const e=n+this.i,s=this.ast.comments[e];if(s&&s.length){let i=" // ";return s.forEach(l=>{i+=l+"; "}),i=i.substring(0,i.length-2),i}return""}genBlockComment(n){let e="";const s=n+this.i,i=this.ast.comments[s];return i&&i.length&&i.forEach(l=>{e+=this.genFormatChat(this.level)+"// "+l+`
`}),e}genObjcet(n,e,s=[]){let i="";this.level++,this.i++;const l=this.gen(e,s);return this.options.splitType?i+=this.genObjectCodeWithVar(l,n,e):i+=l,this.level--,i}genObjectCodeWithVar(n,e,s){const i=Ke(s);if(this.objValueMap.has(i))return this.objValueMap.get(i);const l=this.genName(e),u=this.options.genType==="interface";return this.objValueMap.set(i,l),this.vars+=`${this.options.genType} ${l}${u?"":" ="} ${n}${this.options.semicolon?";":""}

`,l}genArray(n,e){if(e.length===0)return"Array< unknow >";let s="Array< ";const i=new Set;let l=[];if(this.options.optimizeArrayOptional){const{optionalKeys:u,newTypes:p}=Ge(e);l=u,e=p}return e.forEach(u=>{j(u)&&i.add(this.genArray(n,u)),S(u)?i.add(this.genObjcet(n,u,l)):i.add(u)}),s+=Array.from(i).join(" | "),s+=" >",s}}function He(t,n){return new Xe(t,n).beginGen()}function Qe(t){const n={splitType:!0,parseArray:!1,required:!0,semicolon:!1,typeSuffix:"Type",typePrefix:"",indent:2,comment:!1,optimizeArrayOptional:!1,genType:"type"};return Object.assign(n,t),n}function Ze(t,n={}){const e=Qe(n),s=qe(t,e);return We(s,e),He(s,e)}const et={class:"tool-head"},tt={class:"value"},nt=w("\u683C\u5F0F\u5316"),st=w("\u8F6C\u6362"),it={class:"right"},lt=w("\u590D\u5236"),rt=fe({__name:"json2ts",setup(t){const{toClipboard:n}=_e(),e=T(`{
    "createId": 9,
    "ab": {
        "categoryId": 56,
        "extension": "voluptate cupidatat consequat nisi aliquip",
        "updatedAt": "2016-10-01 10:29:56",
        "deletedAt": null,
        "dd": {
            "categoryId": 56,
            "extension": "voluptate cupidatat consequat nisi aliquip",
            "updatedAt": "2016-10-01 10:29:56",
            "deletedAt": null
        }
    },
    "data": {
        "categoryId": 56,
        "extension": "voluptate cupidatat consequat nisi aliquip",
        "updatedAt": "2016-10-01 10:29:56",
        "deletedAt": null
    },
    "cc": [
        {
            "categoryId": 56,
            "extension": "voluptate cupidatat consequat nisi aliquip",
            "updatedAt": "2016-10-01 10:29:56",
            "deletedAt": null
        },
        {
            "categoryId": 56,
            "extension": "voluptate cupidatat consequat nisi aliquip",
            "updatedAt": "2016-10-01 10:29:56",
            "deletedAt": null
        }
    ]
}`),s=T(),i="calc(100vh - 130px)",l=T(!1),u=pe({typeSuffix:"Dto",genType:"interface"}),p=T(["Dto","Type","Modal"]),_=m=>{u.typeSuffix=m},g=(m,f)=>{const C=m?p.value.filter(ee(m)):p.value;f(C)},ee=m=>f=>f.toLowerCase().indexOf(m.toLowerCase())===0,te=()=>{if(!!e.value)try{s.value=Ze(e.value,{splitType:!0,semicolon:!0,parseArray:!0,typeSuffix:u.typeSuffix,comment:"inline",genType:u.genType})}catch{s.value="",N.error("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")}},ne=()=>{if(!e.value)return;const m=JSON.parse(e.value);e.value="",ge(()=>{e.value=JSON.stringify(m,null,4)})},se=async()=>{if(!s.value)return N.info("\u6CA1\u6709\u5185\u5BB9");try{await n(s.value),l.value=!0,setTimeout(()=>{l.value=!1},1e3)}catch{l.value=!1,N.error("\u590D\u5236\u5931\u8D25")}};return(m,f)=>{const C=ve,ie=Ee,b=Ce,le=Te,O=Ae,oe=be,ue=me,k=Oe,ae=Ve;return he(),ye("div",null,[V("div",et,[a(oe,{"label-width":"40px",inline:!0,size:"small",class:"no-bottom"},{default:c(()=>[a(b,{label:"\u5B9A\u4E49"},{default:c(()=>[a(ie,{modelValue:u.genType,"onUpdate:modelValue":f[0]||(f[0]=d=>u.genType=d),class:"w-100"},{default:c(()=>[a(C,{label:"type",value:"type"}),a(C,{label:"interface",value:"interface"})]),_:1},8,["modelValue"])]),_:1}),a(b,{label:"\u540E\u7F00"},{default:c(()=>[a(le,{modelValue:u.typeSuffix,"onUpdate:modelValue":f[1]||(f[1]=d=>u.typeSuffix=d),size:"small","fetch-suggestions":g,onSelect:_,clearable:"",class:"w-100",placeholder:"\u8F93\u5165\u6216\u9009\u62E9"},{default:c(({item:d})=>[V("div",tt,de(d),1)]),_:1},8,["modelValue"])]),_:1}),a(b,null,{default:c(()=>[a(O,{type:"default",onClick:ne},{default:c(()=>[nt]),_:1}),a(O,{type:"primary",onClick:te},{default:c(()=>[st]),_:1})]),_:1})]),_:1}),V("div",it,[a(ue,{visible:l.value,"show-arrow":!1,effect:"light",placement:"left",content:"\u590D\u5236\u6210\u529F"},{default:c(()=>[a(O,{type:"default",size:"small",onClick:se},{default:c(()=>[lt]),_:1})]),_:1},8,["visible"])])]),a(ae,null,{default:c(()=>[a(k,{span:12},{default:c(()=>[a(M,{class:"r-b",value:e.value,"onUpdate:value":f[2]||(f[2]=d=>e.value=d),height:i,language:"json",placeholder:"\u8BF7\u8F93\u5165\u9700\u8981\u8F6C\u6362\u7684JSON"},null,8,["value"])]),_:1}),a(k,{span:12},{default:c(()=>[a(M,{value:s.value,"onUpdate:value":f[3]||(f[3]=d=>s.value=d),language:"typescript",height:i},null,8,["value"])]),_:1})]),_:1})])}}});export{rt as default};
