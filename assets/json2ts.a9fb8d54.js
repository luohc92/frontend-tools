var ae=Object.defineProperty;var ce=(t,n,e)=>n in t?ae(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var y=(t,n,e)=>(ce(t,typeof n!="symbol"?n+"":n,e),e);import{d as fe,r as A,a as me,E as pe,c as ye,b as O,e as u,w as c,o as he,t as de,f as w,n as ge}from"./index.c72f896c.js";import{c as _e,E as ve,a as Ee,b as Ce,d as Ae,e as be,f as Te,g as Ve,h as Oe,_ as M,i as j}from"./mirrorEditor.vue_vue_type_style_index_0_lang.ea91f4a4.js";const je="Root",B="string",L="number",Y="null",x="boolean",P="undefined",D="Object",q="Array",U="Comment",Ne="root",b="$ARRAY_ITEM$",K="$LAST_COMMENT$",Se="$NEXT_COMMENT$",R="array should be closed",$e="comment is illegal",we="value is illegal";function E(t){const{offset:n,column:e,line:s}=t;return{offset:n,column:e,line:s}}function G(t,n,e){return e=e||E(t),{start:n,end:e,source:t.originalSource.slice(n.offset,e.offset)}}function ke(t,n){return{options:n,column:1,line:1,offset:0,originalSource:t,source:t}}function Me(t){return{key:Ne,type:je,value:t}}function z(t){return!t.source}function Re(t,n,e=n.length){let s=0,i=-1;for(let o=0;o<e;o++)n.charCodeAt(o)===10&&(s++,i=o);t.offset+=e,t.line+=s,t.column=i===-1?t.column+e:e-i}function a(t,n){const e=t.source;Re(t,e,n),t.source=e.slice(n)}function h(t){const n=/^[\t\r\n\f ]+/.exec(t.source);n&&n[0]&&a(t,n[0].length)}function J(t,n){h(t);const e=E(t);let s=n||Fe(t);const{value:i,type:o}=Pe(t),r=G(t,e);return h(t),t.source[0]===","&&(a(t,1),h(t)),{key:s,value:i,type:o,loc:r}}function W(t){const n=[];for(;!z(t);){h(t);const e=t.source;if(e[0]==="{")a(t,1);else{if(e[0]==="}")return a(t,1),h(t),n;if(e[0]==="/")if(e[1]==="/"){const s=n[n.length-1];let i=-1;s&&(i=s.loc.end.line),n.push(X(t,i)),h(t)}else throw new Error($e);else n.push(J(t))}}return n}function Fe(t){const n=t.source[0];let e=[];return n==='"'?e=/^"(.[^"]*)/i.exec(t.source):n==="'"?e=/^'(.[^']*)/i.exec(t.source):(e=/(.[^:]*)/i.exec(t.source),e[1]=e[1].trim()),a(t,e[0].length+1),h(t),t.source[0]===":"&&(a(t,1),h(t)),e[1]}function Ie(t){const n=/^([0-9]*)/i.exec(t.source);return a(t,n[0].length),n[1]}function Be(t){const n=/^["|']([^"|']*)/i.exec(t.source);return a(t,n[0].length+1),n[1]}function Le(t){return a(t,4),"null"}function Ye(t){const n=/^(true|false)/i.exec(t.source);return a(t,n[0].length),n[1]}function xe(t){return a(t,9),"undefined"}function Pe(t){let n=null,e=null,s=t.source[0];if(/^[0-9]/.test(s))n=Ie(t),e=L;else if(s==='"'||s==="'")n=Be(t),e=B;else if(s==="[")a(t,1),n=De(t),e=q;else if(s==="{")n=W(t),e=D;else if(t.source.indexOf("null")===0)n=Le(t),e=Y;else if(t.source.indexOf("true")===0||t.source.indexOf("false")===0)n=Ye(t),e=x;else if(t.source.indexOf("undefined")===0)n=xe(t),e=P;else throw new Error(we);return{value:n,type:e}}function De(t){const n=[];let e=E(t).line;for(h(t);!z(t);){const s=t.source[0];if(s==="]")return a(t,1),n;if(s==="}"||s===":")throw new Error(R);if(t.source.indexOf("//")===0){const i=X(t,e);n.push(i),h(t)}else{const i=J(t,b);e=i.loc.end.line,n.push(i)}}throw new Error(R)}function X(t,n){const e=E(t).line,s=n===e?K:Se,i=/^\/\/\s*(.[^\t\n\r\f]*)/i.exec(t.source),o=E(t),r=i[1];return a(t,i[0].length),{key:s,value:r,type:U,loc:G(t,o)}}function qe(t,n){const e=ke(t,n);return Me(W(e))}function H(t){return Object.prototype.toString.call(t)}function N(t){return typeof t=="object"&&H(t).slice(8,-1)==="Array"}function S(t){return typeof t=="object"&&H(t).slice(8,-1)==="Object"}function Ue(t){return t.replace(/( |^)[a-z]/g,n=>n.toUpperCase())}function Ke(t){const n=Object.keys(t).sort();let e="{";for(const s of n)e+=`${s}:${t[s]},`;return e=e.replace(/,$/,""),e+="}",e}function Ge(t,n=""){const e=[],s={};let i=0;const o=[],r={};for(let m=0;m<t.length;m++){const _=t[m];S(_)?(i++,Object.keys(_).forEach(g=>{r[g]=_[g],s[`${n}>${g}`]?s[`${n}>${g}`]+=1:s[`${n}>${g}`]=1})):o.push(_)}return Object.keys(s).forEach(m=>{s[m]<i&&e.push(m)}),Object.keys(r).length&&o.push(r),{optionalKeys:e,newTypes:o}}function ze(t,n,e=""){const s=e+">"+n;for(const i of t)if(s===i)return!0;return!1}let l=Q();function Q(){return{comments:{},i:0,lastI:null,lastNode:null,nextComment:[]}}function v(t,n,e){t.i=l.i,t.key===b?(l.nextComment=[],e.parseArray&&(n.typeValue=n.typeValue||[],n.typeValue.push(t.type))):(n.typeValue=n.typeValue||{},typeof n.typeValue=="object"&&Array.isArray(n.typeValue)&&(n.typeValue[t.key]=t.type),$(t))}function $(t){if(l.lastNode=t,l.nextComment.length){const n=l.comments,e=t.key+l.i;n[e]=n[e]||[],n[e]=n[e].concat(l.nextComment),l.nextComment=[]}}function F(t){l.nextComment.length&&(t.nextComment=l.nextComment,l.nextComment=[])}function I(t){if(t.nextComment){const n=l.comments,e=t.key+t.i;n[e]=n[e]||[],n[e]=n[e].concat(t.nextComment),l.nextComment=[]}}function Z(t,n,e){t.forEach(s=>{let i=e[s.type];i&&i.entry&&i.entry(s,n),N(s.value)&&Z(s.value,s,e),i&&i.exit&&i.exit(s,n)})}function Je(t,n){let e=n.Root;return e&&e.entry&&e.entry(t,null),Z(t.value,t,n),e&&e.exit&&e.exit(t,null),t}function We(t,n){return Je(t,{[B]:{entry(e,s){!s||!n||v(e,s,n)}},[L]:{entry(e,s){!s||!n||v(e,s,n)}},[D]:{entry(e,s){!s||!n||(e.key===b?(l.nextComment=[],n.parseArray&&(s.typeValue=s.typeValue||[],e.typeValue={},s.typeValue.push(e.typeValue),e.i=l.i,l.i++)):(s.typeValue=s.typeValue||{},typeof s.typeValue=="object"&&Array.isArray(s.typeValue)&&(s.typeValue[e.key]=e.typeValue={}),n.comment==="inline"?F(e):n.comment==="block"&&$(e),e.i=l.i,l.i++))},exit(e){!n||(n.comment==="inline"&&(e.i=l.i,I(e)),l.lastNode=e)}},[q]:{entry(e,s){if(e.key===b){if(l.nextComment=[],!n)return;if(n.parseArray){if(!s)return;s.typeValue=s.typeValue||[],e.typeValue=[],s.typeValue.push(e.typeValue)}}else{if(!s||(s.typeValue=s.typeValue||{},typeof s.typeValue=="object"&&Array.isArray(s.typeValue)&&(s.typeValue[e.key]=e.typeValue=[]),!n))return;n.comment==="inline"?F(e):n.comment==="block"&&$(e)}e.i=l.i},exit(e){!n||(n.comment==="inline"&&(e.i=l.i,I(e)),l.lastNode=e)}},[Y]:{entry(e,s){!s||!n||v(e,s,n)}},[x]:{entry(e,s){!s||!n||v(e,s,n)}},[P]:{entry(e,s){!s||!n||v(e,s,n)}},[U]:{entry(e){if(e.key===K){if(!l||!l.lastNode)return;const s=l.lastNode.key+l.lastNode.i;typeof l.comments=="object"&&Array.isArray(l.comments)&&(l.comments[s]=l.comments[s]||[],l.comments[s].push(e.value))}else if(typeof l.comments=="object"&&Array.isArray(l.comments)){if(!e||!e.value)return;l.nextComment.push(e.value)}}}}),t.comments=l.comments,l=Q(),t}class Xe{constructor(n,e){y(this,"ast");y(this,"options");y(this,"vars");y(this,"i");y(this,"j");y(this,"level");y(this,"prefix");y(this,"suffix");y(this,"objValueMap");this.ast=n,this.options=e,this.prefix=e.typePrefix||"",this.suffix=e.typeSuffix||"",this.vars="",this.i=0,this.j=-1,this.level=1,this.objValueMap=new Map}beginGen(){const n=this.genName("Result"),e=this.ast.typeValue,s=this.gen(e),i=this.options.genType==="interface";return`${this.vars}${this.options.genType} ${n}${i?"":" ="} ${s}${this.options.semicolon?";":""}
`}gen(n,e=[]){let s=`{
`;for(const i in n){const o=n[i];this.options.comment==="block"&&(s+=this.genBlockComment(i)),s+=this.genKey(i,ze(e,i)),S(o)?s+=this.genObjcet(i,o):N(o)?s+=this.options.parseArray?this.genArray(i,o):"Array<any>":s+=o,this.options.semicolon&&(s+=";"),this.options.comment==="inline"&&(s+=this.genInlineComment(i)),s+=`
`}return this.options.splitType||(s+=this.genFormatChat(this.level-1)),s+="}",s}genName(n){return this.j++,`${this.prefix}${Ue(n)}${this.suffix}`}genKey(n,e=!1){return`${this.genFormatChat(this.level)}${n}${this.options.required&&!e?": ":"?: "}`}genFormatChat(n){const e=this.options.indent||2;return this.options.splitType?" ".repeat(e):" ".repeat(n*e)}genInlineComment(n){const e=n+this.i,s=this.ast.comments[e];if(s&&s.length){let i=" // ";return s.forEach(o=>{i+=o+"; "}),i=i.substring(0,i.length-2),i}return""}genBlockComment(n){let e="";const s=n+this.i,i=this.ast.comments[s];return i&&i.length&&i.forEach(o=>{e+=this.genFormatChat(this.level)+"// "+o+`
`}),e}genObjcet(n,e,s=[]){let i="";this.level++,this.i++;const o=this.gen(e,s);return this.options.splitType?i+=this.genObjectCodeWithVar(o,n,e):i+=o,this.level--,i}genObjectCodeWithVar(n,e,s){const i=Ke(s);if(this.objValueMap.has(i))return this.objValueMap.get(i);const o=this.genName(e),r=this.options.genType==="interface";return this.objValueMap.set(i,o),this.vars+=`${this.options.genType} ${o}${r?"":" ="} ${n}${this.options.semicolon?";":""}

`,o}genArray(n,e){if(e.length===0)return"Array< unknow >";let s="Array< ";const i=new Set;let o=[];if(this.options.optimizeArrayOptional){const{optionalKeys:r,newTypes:m}=Ge(e);o=r,e=m}return e.forEach(r=>{N(r)&&i.add(this.genArray(n,r)),S(r)?i.add(this.genObjcet(n,r,o)):i.add(r)}),s+=Array.from(i).join(" | "),s+=" >",s}}function He(t,n){return new Xe(t,n).beginGen()}function Qe(t){const n={splitType:!0,parseArray:!1,required:!0,semicolon:!1,typeSuffix:"Type",typePrefix:"",indent:2,comment:!1,optimizeArrayOptional:!1,genType:"type"};return Object.assign(n,t),n}function Ze(t,n={}){const e=Qe(n),s=qe(t,e);return We(s,e),He(s,e)}const et={class:"tool-head"},tt={class:"value"},nt=w("\u683C\u5F0F\u5316"),st=w("\u8F6C\u6362"),it={class:"right"},lt=w("\u590D\u5236"),at=fe({__name:"json2ts",setup(t){const{toClipboard:n}=_e(),e=A(`{
    "createId": 9,
    "ab": {
        "categoryId": 56,
        "extension": "voluptate cupidatat consequat nisi aliquip",
        "updatedAt": "2016-10-01 10:29:56",
        "deletedAt": null,
        "dd": {
            "categoryId": 56,
            "extension": "voluptate cupidatat consequat nisi aliquip",
            "updatedAt": "2016-10-01 10:29:56",
            "deletedAt": null
        }
    },
    "data": {
        "categoryId": 56,
        "extension": "voluptate cupidatat consequat nisi aliquip",
        "updatedAt": "2016-10-01 10:29:56",
        "deletedAt": null
    },
    "cc": [
        {
            "categoryId": 56,
            "extension": "voluptate cupidatat consequat nisi aliquip",
            "updatedAt": "2016-10-01 10:29:56",
            "deletedAt": null
        },
        {
            "categoryId": 56,
            "extension": "voluptate cupidatat consequat nisi aliquip",
            "updatedAt": "2016-10-01 10:29:56",
            "deletedAt": null
        }
    ]
}`),s=A(),i="calc(100vh - 130px)",o=A(!1),r=me({typeSuffix:"Dto",genType:"interface"}),m=A(["Dto","Type","Modal"]),_=p=>{r.typeSuffix=p},g=(p,f)=>{const C=p?m.value.filter(ee(p)):m.value;f(C)},ee=p=>f=>f.toLowerCase().indexOf(p.toLowerCase())===0,te=()=>{if(!!e.value)try{s.value=Ze(e.value,{splitType:!0,semicolon:!0,parseArray:!0,typeSuffix:r.typeSuffix,comment:"inline",genType:r.genType})}catch{s.value="",j.error("JSON\u683C\u5F0F\u4E0D\u6B63\u786E")}},ne=()=>{if(!e.value)return;const p=JSON.parse(e.value);e.value="",ge(()=>{e.value=JSON.stringify(p,null,4)})},se=async()=>{if(!s.value)return j.info("\u6CA1\u6709\u5185\u5BB9");try{await n(s.value),o.value=!0,setTimeout(()=>{o.value=!1},1e3)}catch{o.value=!1,j.error("\u590D\u5236\u5931\u8D25")}};return(p,f)=>{const C=ve,ie=Ee,T=Ce,le=Ae,V=be,oe=Te,re=pe,k=Ve,ue=Oe;return he(),ye("div",null,[O("div",et,[u(oe,{"label-width":"40px",inline:!0,size:"small",class:"no-bottom"},{default:c(()=>[u(T,{label:"\u5B9A\u4E49"},{default:c(()=>[u(ie,{modelValue:r.genType,"onUpdate:modelValue":f[0]||(f[0]=d=>r.genType=d),class:"w-100"},{default:c(()=>[u(C,{label:"type",value:"type"}),u(C,{label:"interface",value:"interface"})]),_:1},8,["modelValue"])]),_:1}),u(T,{label:"\u540E\u7F00"},{default:c(()=>[u(le,{modelValue:r.typeSuffix,"onUpdate:modelValue":f[1]||(f[1]=d=>r.typeSuffix=d),size:"small","fetch-suggestions":g,onSelect:_,clearable:"",class:"w-100",placeholder:"\u8F93\u5165\u6216\u9009\u62E9"},{default:c(({item:d})=>[O("div",tt,de(d),1)]),_:1},8,["modelValue"])]),_:1}),u(T,null,{default:c(()=>[u(V,{type:"default",onClick:ne},{default:c(()=>[nt]),_:1}),u(V,{type:"primary",onClick:te},{default:c(()=>[st]),_:1})]),_:1})]),_:1}),O("div",it,[u(re,{visible:o.value,"show-arrow":!1,effect:"light",placement:"left",content:"\u590D\u5236\u6210\u529F"},{default:c(()=>[u(V,{type:"default",size:"small",onClick:se},{default:c(()=>[lt]),_:1})]),_:1},8,["visible"])])]),u(ue,null,{default:c(()=>[u(k,{span:12},{default:c(()=>[u(M,{class:"r-b",value:e.value,"onUpdate:value":f[2]||(f[2]=d=>e.value=d),height:i,language:"json",placeholder:"\u8BF7\u8F93\u5165\u9700\u8981\u8F6C\u6362\u7684JSON"},null,8,["value"])]),_:1}),u(k,{span:12},{default:c(()=>[u(M,{value:s.value,"onUpdate:value":f[3]||(f[3]=d=>s.value=d),language:"typescript",height:i},null,8,["value"])]),_:1})]),_:1})])}}});export{at as default};
